function searchPattern(target, pattern) {
	Memory.scan(ptr(target[0]), target[1] * 1, pattern, {
		onMatch: function(address, size) {
			send('Replace Success : ' + address + ' ' + size);
			var original_protection = Process.findRangeByAddress(ptr(address)).protection;
			Memory.protect(ptr(address), size, 'rwx');
			Memory.writeByteArray(ptr(address), ['0x43', '0x68', '0x34', '0x6e', '0x6a', '0x75', '0x6e', '0x43', '0x68', '0x34', '0x6e', '0x6a', '0x75', '0x6e', '0x43', '0x68', '0x34', '0x6e', '0x6a', '0x75']);
			Memory.protect(ptr(address), size, original_protection);
		},
		onComplete: function() {
			return;
		}
	});
}

var pattern = "44 65 76 69 63 65 20 69 73 20 4a 61 69 6c 62 72 6f 6b 65 6e";
setTimeout(function() {
	if(ObjC.available) {
		send('Replace All Start!!!');
		var searchList = [['0x280000000', '536870912'], ['0x1beefc000', '126582784'], ['0x1b3654000', '160071680'], ['0x182844000', '786497536'], ['0x16f928000', '557056'], ['0x16f810000', '557056'], ['0x16f6f8000', '557056'], ['0x16f66c000', '557056'], ['0x16f554000', '557056'], ['0x16f4c8000', '557056'], ['0x16f2b0000', '1032192'], ['0x108ef0000', '16384'], ['0x108eec000', '16384'], ['0x108ee8000', '16384'], ['0x108ee4000', '16384'], ['0x108e70000', '16384'], ['0x108e6c000', '16384'], ['0x10865c000', '753664'], ['0x108458000', '2101248'], ['0x108300000', '1409024'], ['0x1082fc000', '16384'], ['0x1082b0000', '311296'], ['0x1082ac000', '16384'], ['0x108288000', '147456'], ['0x108284000', '16384'], ['0x1080ec000', '1671168'], ['0x1080e4000', '16384'], ['0x1080d8000', '16384'], ['0x1080d0000', '16384'], ['0x1080c4000', '49152'], ['0x1080bc000', '32768'], ['0x107ffc000', '16384'], ['0x107cf8000', '65536'], ['0x107cf4000', '16384'], ['0x107ae4000', '2048000'], ['0x1078f4000', '2031616'], ['0x107850000', '671744'], ['0x107794000', '761856'], ['0x107314000', '4718592'], ['0x1071bc000', '1400832'], ['0x107000000', '1814528'], ['0x1067ec000', '8470528'], ['0x10675c000', '557056'], ['0x106718000', '274432'], ['0x106704000', '81920'], ['0x1066fc000', '32768'], ['0x1066ec000', '65536'], ['0x1066e8000', '16384'], ['0x1066e4000', '16384'], ['0x1066dc000', '32768'], ['0x1066cc000', '65536'], ['0x106234000', '4816896'], ['0x104800000', '27463680'], ['0x104000000', '8388608'], ['0x103f20000', '917504'], ['0x103e00000', '1175552'], ['0x103c00000', '2097152'], ['0x103ba0000', '393216'], ['0x103b8c000', '81920'], ['0x103b88000', '16384'], ['0x103b74000', '81920'], ['0x103b64000', '65536'], ['0x103b60000', '16384'], ['0x103b54000', '49152'], ['0x103b50000', '16384'], ['0x103b44000', '49152'], ['0x103b40000', '16384'], ['0x103b3c000', '4096'], ['0x103b30000', '49152'], ['0x103b10000', '131072'], ['0x103ae8000', '163840'], ['0x103a00000', '950272'], ['0x1038f8000', '1081344'], ['0x1038f0000', '16384'], ['0x1038e0000', '49152'], ['0x1038d8000', '16384'], ['0x1038cc000', '16384'], ['0x1038c4000', '16384'], ['0x1038c0000', '16384'], ['0x103878000', '294912'], ['0x103870000', '32768'], ['0x103868000', '32768'], ['0x10384c000', '114688'], ['0x103814000', '229376'], ['0x103804000', '40960'], ['0x102f00000', '9453568'], ['0x102ef4000', '49152'], ['0x102ef0000', '16384'], ['0x102eec000', '16384'], ['0x102ee4000', '16384'], ['0x102ed8000', '16384'], ['0x102ed0000', '16384'], ['0x102ecc000', '16384'], ['0x102e94000', '217088'], ['0x102e90000', '16384'], ['0x102e60000', '196608'], ['0x102e58000', '20480'], ['0x102e54000', '16384'], ['0x102e4c000', '32768'], ['0x102e3c000', '53248'], ['0x102e38000', '16384'], ['0x102e2c000', '49152'], ['0x102e28000', '16384'], ['0x102de0000', '290816'], ['0x102ddc000', '16384'], ['0x102dac000', '196608'], ['0x102da8000', '16384'], ['0x102da4000', '16384'], ['0x102d9c000', '32768'], ['0x102d94000', '32768'], ['0x102d90000', '16384'], ['0x102d88000', '32768'], ['0x102d80000', '24576'], ['0x102d7c000', '16384'], ['0x102d74000', '32768'], ['0x102d5c000', '98304'], ['0x102c38000', '1191936'], ['0x102c20000', '98304'], ['0x102ac8000', '1409024'], ['0x102ac4000', '16384'], ['0x102a98000', '176128'], ['0x102a90000', '32768'], ['0x102a70000', '131072'], ['0x102a64000', '45056'], ['0x102a60000', '16384'], ['0x102a58000', '32768'], ['0x102a50000', '24576'], ['0x102a4c000', '16384'], ['0x102a44000', '32768'], ['0x102a3c000', '24576'], ['0x102a38000', '16384'], ['0x102a30000', '32768'], ['0x102a18000', '90112'], ['0x102a14000', '16384'], ['0x102a04000', '65536'], ['0x1029f4000', '53248'], ['0x1029f0000', '16384'], ['0x1029e4000', '49152'], ['0x1029a8000', '245760'], ['0x1026e8000', '2879488'], ['0x102684000', '409600'], ['0x102308000', '3653632'], ['0x102304000', '16384'], ['0x1022f4000', '65536'], ['0x1022f0000', '16384'], ['0x1022dc000', '81920'], ['0x102220000', '761856'], ['0x102210000', '65536'], ['0x1021bc000', '344064'], ['0x101d2c000', '4775936'], ['0x101cf8000', '212992'], ['0x101704000', '6242304'], ['0x1015e4000', '1171456'], ['0x1015a8000', '245760'], ['0x101460000', '1343488'], ['0x10145c000', '16384'], ['0x101430000', '176128'], ['0x1013f8000', '229376'], ['0x10139c000', '376832'], ['0x101394000', '32768'], ['0x101390000', '16384'], ['0x10138c000', '16384'], ['0x101384000', '32768'], ['0x101318000', '430080'], ['0x1012e0000', '229376'], ['0x101210000', '851968'], ['0x10120c000', '16384'], ['0x101208000', '12288'], ['0x101204000', '16384'], ['0x1011fc000', '32768'], ['0x1011e8000', '69632'], ['0x1011e0000', '32768'], ['0x1011d0000', '65536'], ['0x1011c4000', '49152'], ['0x1011bc000', '32768'], ['0x1011a0000', '114688'], ['0x101194000', '45056'], ['0x101190000', '16384'], ['0x101184000', '49152'], ['0x100ea4000', '3006464'], ['0x100df8000', '704512'], ['0x100a54000', '3817472']];
		for(var i=0; i<searchList.length; ++i) {
			searchPattern(searchList[i], pattern);
		}
	}
}, 0);