function searchPattern(target, pattern) {
	Memory.scan(ptr(target[0]), target[1] * 1, pattern, {
		onMatch: function(address, size) {
			send('Replace Success : ' + address + ' ' + size);
			var original_protection = Process.findRangeByAddress(ptr(address)).protection;
			Memory.protect(ptr(address), size, 'rwx');
			Memory.writeByteArray(ptr(address), ['0x4a', '0x61', '0x69', '0x6c', '0x62', '0x72', '0x65', '0x61', '0x6b', '0x20', '0x44', '0x65', '0x31', '0x31', '0x31', '0x31', '0x69', '0x6f', '0x6e']);
			Memory.protect(ptr(address), size, original_protection);
		},
		onComplete: function() {
			return;
		}
	});
}

var pattern = "4a 61 69 6c 62 72 65 61 6b 20 44 65 74 65 63 74 69 6f 6e";
setTimeout(function() {
	if(ObjC.available) {
		send('Replace All Start!!!');
		var searchList = [['0x280000000', '536870912'], ['0x1beefc000', '126582784'], ['0x1b3654000', '160071680'], ['0x182844000', '786497536'], ['0x16fa44000', '557056'], ['0x16f9b8000', '557056'], ['0x16f92c000', '557056'], ['0x16f8a0000', '557056'], ['0x16f3cc000', '1032192'], ['0x155d00000', '29360128'], ['0x1053b0000', '163840'], ['0x1053a8000', '16384'], ['0x10539c000', '16384'], ['0x105394000', '16384'], ['0x105390000', '16384'], ['0x105354000', '49152'], ['0x103910000', '27463680'], ['0x1037a8000', '24576'], ['0x1037a4000', '16384'], ['0x1037a0000', '16384'], ['0x10379c000', '16384'], ['0x103798000', '16384'], ['0x103724000', '16384'], ['0x103720000', '16384'], ['0x102f88000', '262144'], ['0x102f68000', '131072'], ['0x102f40000', '163840'], ['0x102e58000', '950272'], ['0x102e50000', '32768'], ['0x102e48000', '32768'], ['0x102e2c000', '114688'], ['0x102df4000', '229376'], ['0x102df0000', '16384'], ['0x102de4000', '16384'], ['0x102de0000', '16384'], ['0x102dd4000', '49152'], ['0x102dd0000', '16384'], ['0x102dcc000', '16384'], ['0x102dc8000', '16384'], ['0x102dc0000', '16384'], ['0x102db4000', '16384'], ['0x102dac000', '16384'], ['0x102da8000', '16384'], ['0x102d70000', '217088'], ['0x102d6c000', '16384'], ['0x102d3c000', '196608'], ['0x102d34000', '20480'], ['0x102d30000', '16384'], ['0x102d28000', '32768'], ['0x102d18000', '53248'], ['0x102d14000', '16384'], ['0x102d08000', '49152'], ['0x102d04000', '16384'], ['0x102cbc000', '290816'], ['0x102cb8000', '16384'], ['0x102c88000', '196608'], ['0x102c84000', '16384'], ['0x102c80000', '16384'], ['0x102c78000', '32768'], ['0x102c70000', '32768'], ['0x102c6c000', '16384'], ['0x102c64000', '32768'], ['0x102c5c000', '24576'], ['0x102c58000', '16384'], ['0x102c50000', '32768'], ['0x102c38000', '98304'], ['0x102b14000', '1191936'], ['0x102afc000', '98304'], ['0x1029a4000', '1409024'], ['0x1029a0000', '16384'], ['0x102974000', '176128'], ['0x10296c000', '32768'], ['0x10294c000', '131072'], ['0x102940000', '45056'], ['0x10293c000', '16384'], ['0x102934000', '32768'], ['0x10292c000', '24576'], ['0x102928000', '16384'], ['0x102920000', '32768'], ['0x102918000', '24576'], ['0x102914000', '16384'], ['0x10290c000', '32768'], ['0x102908000', '16384'], ['0x102904000', '16384'], ['0x1028fc000', '32768'], ['0x1028e4000', '90112'], ['0x1028e0000', '16384'], ['0x1028d0000', '65536'], ['0x1028cc000', '12288'], ['0x1028c8000', '16384'], ['0x1028c0000', '32768'], ['0x1028b0000', '53248'], ['0x1028ac000', '16384'], ['0x1028a0000', '49152'], ['0x102894000', '45056'], ['0x102890000', '16384'], ['0x102884000', '49152'], ['0x102848000', '245760'], ['0x102588000', '2879488'], ['0x102524000', '409600'], ['0x1021a8000', '3653632'], ['0x1021a4000', '16384'], ['0x102194000', '65536'], ['0x102190000', '16384'], ['0x10217c000', '81920'], ['0x1020c0000', '761856'], ['0x1020b0000', '65536'], ['0x10205c000', '344064'], ['0x101bcc000', '4775936'], ['0x101b98000', '212992'], ['0x1015a4000', '6242304'], ['0x101484000', '1171456'], ['0x101448000', '245760'], ['0x101300000', '1343488'], ['0x101294000', '430080'], ['0x10125c000', '229376'], ['0x10118c000', '851968'], ['0x101178000', '69632'], ['0x101170000', '32768'], ['0x101160000', '65536'], ['0x10115c000', '16384'], ['0x101130000', '176128'], ['0x1010f8000', '229376'], ['0x1010a0000', '360448'], ['0x101094000', '49152'], ['0x10108c000', '32768'], ['0x101084000', '32768'], ['0x101068000', '114688'], ['0x100d88000', '3006464'], ['0x100cdc000', '704512'], ['0x100938000', '3817472']];
		for(var i=0; i<searchList.length; ++i) {
			searchPattern(searchList[i], pattern);
		}
	}
}, 0);